<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>信息呈现绑定 | Y.js</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/yjs-docs-zh-cn/images/yjs_favicon.png">
    <meta name="description" content="对共享数据进行强大抽象的 CRDT 框架。">
    <link rel="preload" href="/yjs-docs-zh-cn/assets/css/0.styles.ff7562c8.css" as="style"><link rel="preload" href="/yjs-docs-zh-cn/assets/js/app.d2498dcb.js" as="script"><link rel="preload" href="/yjs-docs-zh-cn/assets/js/2.c7b6054d.js" as="script"><link rel="preload" href="/yjs-docs-zh-cn/assets/js/9.8fe0424a.js" as="script"><link rel="prefetch" href="/yjs-docs-zh-cn/assets/js/10.e32bb72d.js"><link rel="prefetch" href="/yjs-docs-zh-cn/assets/js/11.e0a07e3c.js"><link rel="prefetch" href="/yjs-docs-zh-cn/assets/js/12.d88de06b.js"><link rel="prefetch" href="/yjs-docs-zh-cn/assets/js/3.d6a19d1d.js"><link rel="prefetch" href="/yjs-docs-zh-cn/assets/js/4.7351e2e0.js"><link rel="prefetch" href="/yjs-docs-zh-cn/assets/js/5.8eee7a66.js"><link rel="prefetch" href="/yjs-docs-zh-cn/assets/js/6.3569bd4e.js"><link rel="prefetch" href="/yjs-docs-zh-cn/assets/js/7.7b309dc5.js"><link rel="prefetch" href="/yjs-docs-zh-cn/assets/js/8.444df5dd.js">
    <link rel="stylesheet" href="/yjs-docs-zh-cn/assets/css/0.styles.ff7562c8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/yjs-docs-zh-cn/" class="home-link router-link-active"><img src="/yjs-docs-zh-cn/images/logo.png" alt="Y.js" class="logo"> <span class="site-name can-hide">Y.js</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://www.febeacon.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  大笑文档
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/yjs-docs-zh-cn/" class="nav-link">
  文档首页
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://www.febeacon.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  大笑文档
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/yjs-docs-zh-cn/" class="nav-link">
  文档首页
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/yjs-docs-zh-cn/routes/" class="sidebar-link">总览</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/#信息呈现绑定-binding" class="sidebar-link">信息呈现绑定 (Binding)</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/#信息分发端-provider" class="sidebar-link">信息分发端 (Provider)</a></li></ul></li><li><a href="/yjs-docs-zh-cn/routes/start.html" class="sidebar-link">开始</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/start.html#示例：观察类型" class="sidebar-link">示例：观察类型</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/start.html#示例：嵌套类型" class="sidebar-link">示例：嵌套类型</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/start.html#示例：使用并组合更新程序" class="sidebar-link">示例：使用并组合更新程序</a></li></ul></li><li><a href="/yjs-docs-zh-cn/routes/API.html" class="sidebar-link">API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/API.html#共享类型" class="sidebar-link">共享类型</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/API.html#y-array" class="sidebar-link">Y.Array</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/API.html#y-map" class="sidebar-link">Y.Map</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/API.html#y-text" class="sidebar-link">Y.Text</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/API.html#y-xmlfragment" class="sidebar-link">Y.XmlFragment</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/API.html#t-xmlelement" class="sidebar-link">T.XmlElement</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/API.html#y-doc" class="sidebar-link">Y.Doc</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/API.html#y-doc-事件" class="sidebar-link">Y.Doc 事件</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/API.html#文档更新" class="sidebar-link">文档更新</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/API.html#相对位置" class="sidebar-link">相对位置</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/API.html#y-undomanager" class="sidebar-link">Y.UndoManager</a></li></ul></li><li><a href="/yjs-docs-zh-cn/routes/CRDT_Algorithm.html" class="sidebar-link">CRDT 算法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/CRDT_Algorithm.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/CRDT_Algorithm.html#状态向量" class="sidebar-link">状态向量</a></li></ul></li><li><a href="/yjs-docs-zh-cn/routes/binding.html" class="active sidebar-link">信息呈现绑定</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/binding.html#y-prosemirror" class="sidebar-link">y-prosemirror</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/binding.html#y-quill" class="sidebar-link">y-quill</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/binding.html#y-codemirror" class="sidebar-link">y-codemirror</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/binding.html#y-monaco" class="sidebar-link">y-monaco</a></li></ul></li><li><a href="/yjs-docs-zh-cn/routes/provider.html" class="sidebar-link">信息分发端</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/provider.html#y-webrtc" class="sidebar-link">y-webrtc</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/provider.html#y-websocket" class="sidebar-link">y-websocket</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/provider.html#y-leveldb" class="sidebar-link">y-leveldb</a></li><li class="sidebar-sub-header"><a href="/yjs-docs-zh-cn/routes/provider.html#y-dat" class="sidebar-link">y-dat</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="信息呈现绑定">信息呈现绑定</h1> <h2 id="y-prosemirror">y-prosemirror</h2> <p><a href="https://github.com/yjs/y-prosemirror" target="_blank" rel="noopener noreferrer">英文原地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p><a href="http://prosemirror.net/" target="_blank" rel="noopener noreferrer">ProseMirror<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>绑定到 Yjs</p></blockquote> <p>该绑定将<code>Y.XmlFragment</code>映射到 ProseMirror 状态。</p> <h3 id="特点">特点</h3> <ul><li>同步 ProseMirror 状态。</li> <li>共享的光标。</li> <li>共享撤消/重做(每个客户端都有自己的撤消/重做历史记录)</li> <li>当并发编辑结果出现无效文档架构时，成功恢复</li></ul> <h4 id="示例">示例</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ySyncPlugin<span class="token punctuation">,</span> yCursorPlugin<span class="token punctuation">,</span> yUndoPlugin<span class="token punctuation">,</span> undo<span class="token punctuation">,</span> redo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'y-prosemirror'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> exampleSetup <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'prosemirror-example-setup'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> keymap <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'prosemirror-keymap'</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">const</span> type <span class="token operator">=</span> ydocument<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'prosemirror'</span><span class="token punctuation">,</span> <span class="token constant">Y</span><span class="token punctuation">.</span>XmlFragment<span class="token punctuation">)</span>

<span class="token keyword">const</span> prosemirrorView <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EditorView</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#editor'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> EditorState<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    schema<span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token function">ySyncPlugin</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">yCursorPlugin</span><span class="token punctuation">(</span>provider<span class="token punctuation">.</span>awareness<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">yUndoPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">keymap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token string">'Mod-z'</span><span class="token punctuation">:</span> undo<span class="token punctuation">,</span>
          <span class="token string">'Mod-y'</span><span class="token punctuation">:</span> redo<span class="token punctuation">,</span>
          <span class="token string">'Mod-Shift-z'</span><span class="token punctuation">:</span> redo
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">exampleSetup</span><span class="token punctuation">(</span><span class="token punctuation">{</span> schema <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><a href="https://github.com/yjs/yjs-demos/tree/master/prosemirror" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>有工作示例。</p> <h4 id="远程光标"><strong>远程光标</strong></h4> <p>远程光标依赖于大多数信息分发端导出的感知实例。感知协议处理非永久性数据，如用户数量、用户名、光标位置和颜色。您可以通过如下方式更改用户的名称和颜色：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>example.binding.awareness.setLocalStateField<span class="token punctuation">(</span><span class="token string">'user'</span>, <span class="token punctuation">{</span> color: <span class="token string">'#008833'</span>, name: <span class="token string">'My real name'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>为了显示光标信息，您需要为用户图标嵌入定制的CSS。下面是一个可以用于样式化光标信息的模板。</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token comment">/* 这段是对第一个段落为空时的第一个光标位置的粗略修正 */</span>
<span class="token selector">.ProseMirror &gt; .ProseMirror-yjs-cursor:first-child</span> <span class="token punctuation">{</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.ProseMirror p:first-child, .ProseMirror h1:first-child, .ProseMirror h2:first-child, .ProseMirror h3:first-child, .ProseMirror h4:first-child, .ProseMirror h5:first-child, .ProseMirror h6:first-child</span> <span class="token punctuation">{</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 16px
<span class="token punctuation">}</span>
<span class="token comment">/* 为远程用户提供光标。颜色会自动覆盖 */</span>
<span class="token selector">.ProseMirror-yjs-cursor</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> -1px<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> -1px<span class="token punctuation">;</span>
  <span class="token property">border-left</span><span class="token punctuation">:</span> 1px solid black<span class="token punctuation">;</span>
  <span class="token property">border-right</span><span class="token punctuation">:</span> 1px solid black<span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> orange<span class="token punctuation">;</span>
  <span class="token property">word-break</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
  <span class="token property">pointer-events</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 将用户名渲染到光标上 */</span>
<span class="token selector">.ProseMirror-yjs-cursor &gt; div</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> -1.05em<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> -1px<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 13px<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>250<span class="token punctuation">,</span> 129<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> serif<span class="token punctuation">;</span>
  <span class="token property">font-style</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
  <span class="token property">user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
  <span class="token property">padding-left</span><span class="token punctuation">:</span> 2px<span class="token punctuation">;</span>
  <span class="token property">padding-right</span><span class="token punctuation">:</span> 2px<span class="token punctuation">;</span>
  <span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>您还可以通过在 yCursorPlugin 中指定一个光标构建器来覆盖默认的部件 DOM。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 该函数接收远程用户的“用户”感知状态.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">myCursorBuilder</span> <span class="token operator">=</span> <span class="token parameter">user</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cursor <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">)</span>
  cursor<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'ProseMirror-yjs-cursor'</span><span class="token punctuation">)</span>
  cursor<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">border-color: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token punctuation">.</span>color<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> userDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  userDiv<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">background-color: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token punctuation">.</span>color<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  userDiv<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
  cursor<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>userDiv<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> cursor
<span class="token punctuation">}</span>

<span class="token keyword">const</span> prosemirrorView <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EditorView</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#editor'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> EditorState<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    schema<span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token function">ySyncPlugin</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">yCursorPlugin</span><span class="token punctuation">(</span>provider<span class="token punctuation">.</span>awareness<span class="token punctuation">,</span> <span class="token punctuation">{</span> cursorBuilder<span class="token punctuation">:</span> myCursorBuilder <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">yUndoPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">keymap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token string">'Mod-z'</span><span class="token punctuation">:</span> undo<span class="token punctuation">,</span>
          <span class="token string">'Mod-y'</span><span class="token punctuation">:</span> redo<span class="token punctuation">,</span>
          <span class="token string">'Mod-Shift-z'</span><span class="token punctuation">:</span> redo
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">exampleSetup</span><span class="token punctuation">(</span><span class="token punctuation">{</span> schema <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="y-quill">y-quill</h2> <blockquote><p><a href="https://quilljs.com/" target="_blank" rel="noopener noreferrer">Quill Editor<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>绑定到 Yjs</p></blockquote> <p>该绑定将<code>Y.Text</code>映射到 Quill 实例。</p> <p>可以选择通过<a href="https://github.com/reedsy/quill-cursors" target="_blank" rel="noopener noreferrer">quill-cursors<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>模块支持共享光标。</p> <h3 id="示例-2">示例</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> QuillBinding <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'y-quill'</span>
<span class="token keyword">import</span> Quill <span class="token keyword">from</span> <span class="token string">'quill'</span>
<span class="token keyword">import</span> QuillCursors <span class="token keyword">from</span> <span class="token string">'quill-cursors'</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span>

Quill<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'modules/cursors'</span><span class="token punctuation">,</span> QuillCursors<span class="token punctuation">)</span>

<span class="token keyword">const</span> type <span class="token operator">=</span> ydoc<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token string">'quill'</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> editor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Quill</span><span class="token punctuation">(</span><span class="token string">'#editor-container'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  modules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    cursors<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    toolbar<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span><span class="token punctuation">{</span> header<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">'bold'</span><span class="token punctuation">,</span> <span class="token string">'italic'</span><span class="token punctuation">,</span> <span class="token string">'underline'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">'image'</span><span class="token punctuation">,</span> <span class="token string">'code-block'</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  placeholder<span class="token punctuation">:</span> <span class="token string">'Start collaborating...'</span><span class="token punctuation">,</span>
  theme<span class="token punctuation">:</span> <span class="token string">'snow'</span> <span class="token comment">// 或 'bubble'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 如果信息分发端支持，可指定一个感知实例</span>
<span class="token keyword">const</span> binding <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QuillBinding</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> editor<span class="token punctuation">,</span> provider<span class="token punctuation">.</span>awareness<span class="token punctuation">)</span>

<span class="token comment">/*
// 定义用户和用户名
// 检查 quill-cursors 以了解如何更改呈现光标的方式
provider.awareness.setLocalStateField('user', {
  name: 'Typing Jimmy',
  color: 'blue'
})
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><a href="https://github.com/y-js/yjs-demos/tree/master/quill" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>有工作示例。</p> <h2 id="y-codemirror">y-codemirror</h2> <p><a href="https://github.com/yjs/y-codemirror" target="_blank" rel="noopener noreferrer">英文原地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p><a href="https://codemirror.net/" target="_blank" rel="noopener noreferrer">CodeMirror<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>绑定到 Yjs</p></blockquote> <p>该绑定将<code>Y.Text</code>映射到 CodeMirror 编辑器。</p> <h3 id="特点-2">特点</h3> <ul><li>同步 CodeMirror 状态。</li> <li>共享的光标。</li> <li>共享撤消/重做(每个客户端都有自己的撤消/重做历史记录)</li> <li>当并发编辑结果出现无效文档架构时，成功恢复</li></ul> <h3 id="示例-3">示例</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">Y</span> <span class="token keyword">from</span> <span class="token string">'yjs'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CodemirrorBinding <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'y-codemirror'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> WebrtcProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'y-webrtc'</span>
<span class="token keyword">import</span> CodeMirror <span class="token keyword">from</span> <span class="token string">'codemirror'</span>

<span class="token keyword">const</span> ydoc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Y<span class="token punctuation">.</span>Doc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> provider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebrtcProvider</span><span class="token punctuation">(</span><span class="token string">'codemirror-demo-room'</span><span class="token punctuation">,</span> ydoc<span class="token punctuation">)</span>
<span class="token keyword">const</span> yText <span class="token operator">=</span> ydoc<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token string">'codemirror'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> editor <span class="token operator">=</span> <span class="token function">CodeMirror</span><span class="token punctuation">(</span>editorDiv<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  mode<span class="token punctuation">:</span> <span class="token string">'javascript'</span><span class="token punctuation">,</span>
  lineNumbers<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> binding <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CodemirrorBinding</span><span class="token punctuation">(</span>yText<span class="token punctuation">,</span> editor<span class="token punctuation">,</span> provider<span class="token punctuation">.</span>awareness<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><a href="https://github.com/yjs/yjs-demos/tree/master/codemirror" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>有工作示例。</p> <h2 id="y-monaco">y-monaco</h2> <p><a href="https://github.com/yjs/y-monaco" target="_blank" rel="noopener noreferrer">英文原地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p><a href="https://microsoft.github.io/monaco-editor/index.html" target="_blank" rel="noopener noreferrer">Monaco<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>绑定到 Yjs</p></blockquote> <p>该绑定将<code>Y.Text</code>映射到 Monaco 编辑器(它就是 VS Code 的编辑器)。</p> <h3 id="特点-3">特点</h3> <ul><li>共享光标</li></ul> <h4 id="示例-4">示例</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">Y</span> <span class="token keyword">from</span> <span class="token string">'yjs'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> WebsocketProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'y-websocket'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> MonacoBinding <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'y-monaco'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> monaco <span class="token keyword">from</span> <span class="token string">'monaco-editor'</span>

<span class="token keyword">const</span> ydocument <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Y<span class="token punctuation">.</span>Doc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> provider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebsocketProvider</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>location<span class="token punctuation">.</span>protocol <span class="token operator">===</span> <span class="token string">'http:'</span> <span class="token operator">?</span> <span class="token string">'ws:'</span> <span class="token punctuation">:</span> <span class="token string">'wss:'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">//localhost:1234</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token string">'monaco'</span><span class="token punctuation">,</span> ydocument<span class="token punctuation">)</span>
<span class="token keyword">const</span> type <span class="token operator">=</span> ydocument<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token string">'monaco'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> editor <span class="token operator">=</span> monaco<span class="token punctuation">.</span>editor<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'monaco-editor'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  value<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// MonacoBinding 使用类型内容覆盖该值</span>
  language<span class="token punctuation">:</span> <span class="token string">&quot;javascript&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 将 Yjs 绑定到编辑器模型</span>
<span class="token keyword">const</span> monacoBinding <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MonacoBinding</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> editor<span class="token punctuation">.</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span>editor<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> provider<span class="token punctuation">.</span>awareness<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><a href="https://github.com/y-js/yjs-demos/tree/master/monaco" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>有工作示例。</p> <h3 id="api">API</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> MonacoBinding <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'y-monaco'</span>

<span class="token keyword">const</span> binding <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MonacoBinding</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> editor<span class="token punctuation">.</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span>editor<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> provider<span class="token punctuation">.</span>awareness<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="class-monacobinding">Class:MonacoBinding</h3> <h4 id="constructor-y-text-monaco-editor-itextmodel-set-monaco-editor-istandalonecodeeditor-awareness"><code>constructor(Y.Text, monaco.editor.ITextModel, [Set&lt;monaco.editor.IStandaloneCodeEditor&gt;, [Awareness]])</code></h4> <p>如果指定了编辑器，MonacoBinding 会在发生远程更改时调整选项。Awareness 是 y-protocols/awareness 感知协议的实现。如果指定了 Awareness, 那么 MonacoBinding 会显示远端的选项。</p> <h4 id="destroy"><code>destroy()</code></h4> <p>取消所有事件监听器。当模型被释放时自动调用。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/yjs-docs-zh-cn/routes/CRDT_Algorithm.html" class="prev">
        CRDT 算法
      </a></span> <span class="next"><a href="/yjs-docs-zh-cn/routes/provider.html">
        信息分发端
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/yjs-docs-zh-cn/assets/js/app.d2498dcb.js" defer></script><script src="/yjs-docs-zh-cn/assets/js/2.c7b6054d.js" defer></script><script src="/yjs-docs-zh-cn/assets/js/9.8fe0424a.js" defer></script>
  </body>
</html>
